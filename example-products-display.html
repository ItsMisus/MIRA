<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizzazione Prodotti - Esempio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a0a;
            color: #fff;
            font-family: 'Rajdhani', Arial, sans-serif;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #9b59b6;
            margin-bottom: 30px;
            text-align: center;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .product-card {
            background: #1f1f1f;
            border: 2px solid #9b59b6;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 0 30px rgba(155, 89, 182, 0.5);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background: #0a0a0a;
        }

        .product-content {
            padding: 20px;
        }

        .product-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #9b59b6;
        }

        .product-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .category-badge, .tag-badge {
            padding: 5px 10px;
            border-radius: 4px;
            color: #fff;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .product-description {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 15px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-components {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 15px;
            padding: 10px;
            background: #0a0a0a;
            border-radius: 5px;
            border-left: 3px solid #9b59b6;
        }

        .price-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
        }

        .discount-price {
            color: #27ae60;
            font-weight: bold;
            font-size: 1.3rem;
        }

        .discount-badge {
            background: #e74c3c;
            color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .add-to-cart {
            width: 100%;
            padding: 12px;
            background: #9b59b6;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .add-to-cart:hover {
            background: #b86ec9;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .pagination button {
            padding: 10px 15px;
            background: #1f1f1f;
            color: #9b59b6;
            border: 2px solid #9b59b6;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .pagination button:hover,
        .pagination button.active {
            background: #9b59b6;
            color: #fff;
        }

        .filters {
            background: #1f1f1f;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #9b59b6;
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 15px;
            background: #2d2d2d;
            color: #9b59b6;
            border: 1px solid #9b59b6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: #9b59b6;
            color: #fff;
        }

        .no-products {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Catalogo PC Gaming</h1>

        <!-- Filtri Categorie -->
        <div class="filters" id="filtersContainer">
            <button class="filter-btn active" onclick="filterProducts('all')">Tutti</button>
        </div>

        <!-- Grid Prodotti -->
        <div class="products-grid" id="productsGrid"></div>

        <!-- Paginazione -->
        <div class="pagination" id="paginationContainer"></div>

        <div class="no-products" id="noProducts" style="display: none;">
            Nessun prodotto trovato
        </div>
    </div>

    <!-- Script Configurazione -->
    <script src="config-admin.js"></script>

    <script>
        let allProducts = [];
        let filteredProducts = [];
        let currentCategory = 'all';
        let currentPage = 1;
        let allCategories = [];
        let allTags = [];

        /**
         * Inizializza la pagina
         */
        async function init() {
            // Carica i dati
            allProducts = await loadProducts();
            allCategories = await loadCategories();
            allTags = await loadTags();

            // Setup filtri
            setupFilters();

            // Mostra prodotti
            filterProducts('all');
        }

        /**
         * Setup dei bottoni filtro
         */
        function setupFilters() {
            const container = document.getElementById('filtersContainer');
            container.innerHTML = '<button class="filter-btn active" onclick="filterProducts(\'all\')">Tutti</button>';

            allCategories.forEach(category => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = category.name;
                btn.style.borderColor = category.color;
                btn.style.color = category.color;
                btn.onclick = () => filterProducts(category.name);
                container.appendChild(btn);
            });
        }

        /**
         * Filtra i prodotti
         */
        function filterProducts(categoryName) {
            currentCategory = categoryName;
            currentPage = 1;

            // Aggiorna bottoni attivi
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filtra prodotti
            if (categoryName === 'all') {
                filteredProducts = allProducts;
            } else {
                filteredProducts = filterByCategory(allProducts, categoryName);
            }

            // Renderizza
            renderProducts();
        }

        /**
         * Renderizza i prodotti
         */
        function renderProducts() {
            const container = document.getElementById('productsGrid');
            const noProducts = document.getElementById('noProducts');

            if (filteredProducts.length === 0) {
                container.innerHTML = '';
                noProducts.style.display = 'block';
                document.getElementById('paginationContainer').innerHTML = '';
                return;
            }

            noProducts.style.display = 'none';

            // Pagina
            const paginated = paginateProducts(filteredProducts, currentPage);
            
            // Renderizza prodotti
            container.innerHTML = paginated.data.map(product => `
                <div class="product-card" onclick="viewProduct('${product.name}')">
                    <img src="${product.img}" alt="${product.name}" class="product-image" onerror="this.src='https://via.placeholder.com/300x250?text=No+Image'">
                    
                    <div class="product-content">
                        <div class="product-name">${product.name}</div>

                        <!-- Categorie e Tag -->
                        <div class="product-badges">
                            ${(product.categories || []).map(cat => {
                                const categoryObj = allCategories.find(c => c.name === cat);
                                return `<span class="category-badge" style="background: ${categoryObj ? categoryObj.color : '#9b59b6'};">${cat}</span>`;
                            }).join('')}

                            ${(product.tags || []).map(tagName => {
                                const tagObj = allTags.find(t => t.name === tagName);
                                return `<span class="tag-badge" style="background: ${tagObj ? tagObj.color : '#e74c3c'};">${tagObj ? tagObj.icon : 'üè∑Ô∏è'} ${tagName}</span>`;
                            }).join('')}
                        </div>

                        <div class="product-description">${product.desc}</div>

                        <div class="product-components">
                            <strong>Specs:</strong> ${product.components}
                        </div>

                        <!-- Prezzo -->
                        <div class="price-container">
                            ${product.discount && product.discountPrice ? `
                                <span class="original-price">‚Ç¨${product.price}</span>
                                <span class="discount-price">‚Ç¨${product.discountPrice}</span>
                                <span class="discount-badge">-${Math.round((1 - product.discountPrice / product.price) * 100)}%</span>
                            ` : `
                                <span class="discount-price">‚Ç¨${product.price}</span>
                            `}
                        </div>

                        <button class="add-to-cart" onclick="event.stopPropagation(); addToCart('${product.name}')">
                            üõí Aggiungi al Carrello
                        </button>
                    </div>
                </div>
            `).join('');

            // Paginazione
            renderPagination(paginated);
        }

        /**
         * Renderizza la paginazione
         */
        function renderPagination(paginated) {
            const container = document.getElementById('paginationContainer');
            container.innerHTML = '';

            // Pulsante precedente
            if (currentPage > 1) {
                const btn = document.createElement('button');
                btn.textContent = '‚Üê Precedente';
                btn.onclick = () => {
                    currentPage--;
                    renderProducts();
                };
                container.appendChild(btn);
            }

            // Numeri pagine
            for (let i = 1; i <= paginated.totalPages; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                if (i === currentPage) btn.classList.add('active');
                btn.onclick = () => {
                    currentPage = i;
                    renderProducts();
                };
                container.appendChild(btn);
            }

            // Pulsante successivo
            if (currentPage < paginated.totalPages) {
                const btn = document.createElement('button');
                btn.textContent = 'Successivo ‚Üí';
                btn.onclick = () => {
                    currentPage++;
                    renderProducts();
                };
                container.appendChild(btn);
            }
        }

        /**
         * Visualizza dettagli prodotto
         */
        function viewProduct(productName) {
            console.log('Visualizzare prodotto:', productName);
            // Reindirizza a pagina dettaglio
            // window.location.href = `product.html?name=${productName}`;
        }

        /**
         * Aggiungi al carrello
         */
        function addToCart(productName) {
            console.log('Aggiunto al carrello:', productName);
            alert(`${productName} aggiunto al carrello!`);
        }

        // Inizializza
        init();
    </script>
</body>
</html>
